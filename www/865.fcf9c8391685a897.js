"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[865],{865:(k,p,s)=>{s.r(p),s.d(p,{SigninPageModule:()=>T});var h=s(6814),a=s(6223),u=s(6728),d=s(2058),m=s(5861),e=s(2029),f=s(2999),v=s(1696),b=s(2014);function M(t,g){1&t&&(e.TgZ(0,"ion-text",11)(1,"p",12),e._uU(2,"El usuario debe contener al menos 5 car\xe1cteres"),e.qZA()())}function P(t,g){1&t&&(e.TgZ(0,"ion-text",11)(1,"p",12),e._uU(2,"La contrase\xf1a es obligatoria"),e.qZA()())}const _=function(){return{standalone:!0}},S=[{path:"",component:(()=>{var t;class g{constructor(o,n,i,r,c){this.router=o,this.djangoApi=n,this.fb=i,this.authService=r,this.storage=c,this.checkBo=!1,this.mensaje="",this.usuario="",this.password="",this.bcred_count=0,this.bloqueo=!1,this.crearFormulario()}crearFormulario(){this.forma=this.fb.group({usuario:["",[a.kI.required,a.kI.minLength(5)]],pass:["",[a.kI.required]]})}get usuarioNoValido(){var o,n;return(null===(o=this.forma.get("usuario"))||void 0===o?void 0:o.invalid)&&(null===(n=this.forma.get("usuario"))||void 0===n?void 0:n.touched)}get contraNoValido(){var o,n;return(null===(o=this.forma.get("pass"))||void 0===o?void 0:o.invalid)&&(null===(n=this.forma.get("pass"))||void 0===n?void 0:n.touched)}get tooManyTries(){return this.bcred_count>=5}ngOnInit(){var o=this;return(0,m.Z)(function*(){yield o.storage.create(),o.storage.get("usuario").then(n=>{o.usuario=n}),o.storage.get("password").then(n=>{o.password=n}),o.storage.get("checkBox").then(n=>{o.checkBo=n})})()}check(){this.storage.set("checkBox",this.checkBo)}goTo(){if(this.bcred_count>=5)return this.mensaje="Demasiados intentos incorrectos, espere 30 segundos para volverlo a intentar",void setTimeout(()=>{this.mensaje="",this.bcred_count=0},3e4);var o,n;this.checkBo?(this.storage.set("usuario",null===(o=this.forma.get("usuario"))||void 0===o?void 0:o.value),this.storage.set("password",null===(n=this.forma.get("pass"))||void 0===n?void 0:n.value)):(this.storage.remove("usuario"),this.storage.remove("password")),this.djangoApi.postData(this.forma.value).subscribe(i=>{2==i.tipo_usuario?(this.authService.login(),this.router.navigate(["/home"],{state:{nombre:i.pnombre_usuario+" "+i.apaterno_usuario,id:i.id_usuario}})):1==i.tipo_usuario&&(this.authService.login(),this.router.navigate(["/profesor"],{state:{nombre:i.pnombre_usuario+" "+i.apaterno_usuario,id:i.id_profesor}})),this.mensaje=""},i=>{console.error("Error durante el inicio de sesi\xf3n:",i),400===i.status?(this.mensaje="Credenciales inv\xe1lidas",setTimeout(()=>{this.mensaje=""},5e3),this.bcred_count+=1,this.bcred_count>=5&&(this.mensaje="Demasiados intentos incorrectos, espere 30 segundos para volverlo a intentar",setTimeout(()=>{this.mensaje="",this.bcred_count=0},3e4))):500===i.status&&(this.mensaje="Error interno del servidor",setTimeout(()=>{this.mensaje=""},5e3))})}}return(t=g).\u0275fac=function(o){return new(o||t)(e.Y36(d.F0),e.Y36(f.a),e.Y36(a.qu),e.Y36(v.e),e.Y36(b.K))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-signin"]],decls:26,vars:14,consts:[["rel","preconnect","href","https://fonts.googleapis.com"],["rel","preconnect","href","https://fonts.gstatic.com","crossorigin",""],["href","https://fonts.googleapis.com/css2?family=Open+Sans&display=swap","rel","stylesheet"],[1,"header"],[1,"title","ion-text-center"],[1,"span"],[3,"formGroup","ngSubmit"],[1,"ion-padding-top"],["label","Usuario","labelPlacement","floating","formControlName","usuario",3,"ngModel","ngModelChange"],["label","Contrase\xf1a","labelPlacement","floating","formControlName","pass","type","password",3,"ngModel","ngModelChange"],["color","danger",4,"ngIf"],["color","danger"],[1,"mensaje"],["justify","end",1,"check",3,"ngModelOptions","ngModel","ngModelChange","ionChange"],[1,"ion-text-center","btn-pad"],["type","submit","value","Ingresar",1,"btn",3,"disabled","click"],["routerLink","/restorepass"]],template:function(o,n){1&o&&(e._UZ(0,"link",0)(1,"link",1)(2,"link",2),e.TgZ(3,"div",3)(4,"h1",4),e._uU(5,"Registrr "),e.TgZ(6,"span",5),e._uU(7,"APP"),e.qZA()()(),e.TgZ(8,"ion-content")(9,"form",6),e.NdJ("ngSubmit",function(){return n.goTo}),e.TgZ(10,"ion-item",7)(11,"ion-input",8),e.NdJ("ngModelChange",function(r){return n.usuario=r}),e.qZA()(),e.TgZ(12,"ion-item")(13,"ion-input",9),e.NdJ("ngModelChange",function(r){return n.password=r}),e.qZA()(),e.YNc(14,M,3,0,"ion-text",10),e.YNc(15,P,3,0,"ion-text",10),e.TgZ(16,"ion-text",11)(17,"p",12),e._uU(18),e.qZA()(),e.TgZ(19,"ion-checkbox",13),e.NdJ("ngModelChange",function(r){return n.checkBo=r})("ionChange",function(){return n.check()}),e._uU(20,"Recuerdame"),e.qZA(),e.TgZ(21,"div",14)(22,"input",15),e.NdJ("click",function(){return n.goTo()}),e.qZA()()(),e.TgZ(23,"div",14)(24,"a",16),e._uU(25,"Olvid\xe9 mi Contrase\xf1a"),e.qZA()()()),2&o&&(e.xp6(9),e.Q6J("formGroup",n.forma),e.xp6(2),e.ekj("is-invalid",n.usuarioNoValido),e.Q6J("ngModel",n.usuario),e.xp6(2),e.ekj("is-invalid",n.contraNoValido),e.Q6J("ngModel",n.password),e.xp6(1),e.Q6J("ngIf",n.usuarioNoValido),e.xp6(1),e.Q6J("ngIf",n.contraNoValido),e.xp6(3),e.Oqu(n.mensaje),e.xp6(1),e.Q6J("ngModelOptions",e.DdM(13,_))("ngModel",n.checkBo),e.xp6(3),e.Q6J("disabled","INVALID"===n.forma.status))},dependencies:[h.O5,a._Y,a.JJ,a.JL,a.On,u.nz,u.W2,u.pK,u.Ie,u.yW,u.w,u.j9,u.Fo,d.rH,a.sg,a.u],styles:['@import"https://fonts.googleapis.com/css2?family=Open+Sans&display=swap";.header[_ngcontent-%COMP%]{background-color:#0f2b53;display:flex;align-items:center;justify-content:center;padding:80px}.btn-pad[_ngcontent-%COMP%]{margin-top:30px}.btn[_ngcontent-%COMP%]{color:#fff;background-color:#f5bf41;border:none;padding:10px 100px;font-size:20px;font-weight:100}.btn[disabled][_ngcontent-%COMP%]{background-color:#e0e0e0;color:#a0a0a0}.btn[_ngcontent-%COMP%]:active:valid{background-color:#4270d9}.title[_ngcontent-%COMP%]{color:#f5bf41;font-size:20px;font-family:Open Sans}.span[_ngcontent-%COMP%]{color:#fff;font-weight:700;font-size:23px}.mensaje[_ngcontent-%COMP%]{padding-left:15px;margin:20px 10px;font-size:14px}.check[_ngcontent-%COMP%]{display:flex;justify-content:end;padding-right:15%;margin-top:5%;margin-bottom:-10px;color:#0f2b53}']}),g})()}];let C=(()=>{var t;class g{}return(t=g).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[d.Bz.forChild(S),d.Bz]}),g})(),T=(()=>{var t;class g{}return(t=g).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.ez,a.u5,u.Pc,C,a.UX]}),g})()}}]);